# WorldOptimizer ユーザーマニュアル

## 1. はじめに
**WorldOptimizer** は、VRChatワールド制作における「最適化（Optimization）」を自動化・支援するためのUnityエディタ拡張ツールです。
ボタン一つでアセットの軽量化を行い、ワールド容量の削減や描画負荷の軽減を実現します。また、元の素材を変更しない「非破壊モード」を搭載しており、安心して使用できます。

---

## 2. インストールと起動
### インストール方法
1. 配布された `WorldOptimizer` フォルダを、Unityプロジェクトの `Assets` フォルダ内にドラッグ＆ドロップで配置してください。

### 起動方法
1. Unityエディタ上部のメニューから **WorldOptimizer > Open Optimizer** を選択します。
2. 「ワールド最適化ツール」ウィンドウが開きます。

---

## 3. 基本的な使い方 (Basic Settings)
ウィンドウの「基本設定」タブでは、一般的な最適化を簡単に行えます。

### ステップ 1: プロファイルの選択
用途に合わせて「最適化プロファイル」を選択します。
- **Standard (標準)**: バランス重視。テクスチャサイズ最大2048px、Crunch圧縮品質50など。
- **HighQuality (高品質)**: 画質重視。テクスチャサイズ最大4096px、Crunch圧縮品質85など。

### ステップ 2: 設定の確認
以下の項目をお好みでオン/オフできます（通常はすべてオン推奨）。

- **Missing Scriptの削除**: 不要なスクリプト参照を削除し、エラーを防ぎます。
- **GPU Instancingの有効化**: 同一マテリアルのオブジェクトをまとめて描画し、CPU負荷を下げます。
- **テクスチャ圧縮の最適化**: テクスチャの解像度制限やStreaming Mipmaps設定を行います。
    - **最大サイズ (Max Size)**: ドロップダウンから上限サイズを指定可能 (例: 2048)。
- **オーディオ設定の最適化**: BGMやSEの設定をVRChat推奨（Vorbis/Monoなど）に変更します。
- **Staticフラグの自動設定**: 動かないオブジェクトにStaticフラグを付け、処理を軽くします。

### ステップ 3: 実行
- **「一括最適化を実行 (Run All)」**: 全てのチェック項目をまとめて処理します。
- **個別の「実行」ボタン**: 各項目（テクスチャ、オーディオ等）の右にあるボタンを押すと、その処理だけを個別に実行できます。

> **安心機能: 非破壊モード (推奨)**
> 「非破壊モード」にチェックを入れると、元のマテリアルやテクスチャを直接変更せず、自動的にコピー（Clone）を作成して最適化を適用します。失敗しても元の状態に戻せるため安全です。

---

## 4. 高度な機能 (Advanced Settings)
「詳細設定」タブでは、より専門的な最適化を行えます。

### メッシュ結合 (Mesh Combiner)
オブジェクト数が多すぎると負荷の原因になります。
1. シーン上で親となるオブジェクトを選択します。
2. **「選択オブジェクトを結合」** をクリックします。
3. マテリアルごとにメッシュが結合され、描画回数（DrawCall）が劇的に削減されます。

### LOD設定 (Level Of Detail)
- **LOD Bias**: 遠くのオブジェクトをどれくらい早く簡易表示にするかを調整します。
    - 値を小さくする（0.5〜1.0）と負荷が下がりますが、遠くの見た目が粗くなります。

### 強力な圧縮 (Crunch Compression)
- **Crunch圧縮を強制**: 通常は対象外のNormap Mapなども含め、強制的にCrunch圧縮をかけます。
- **圧縮品質**: 画質と容量のトレードオフをスライダーで調整できます。

### オクルージョンカリング & ライティング
- **推奨ライトマップ設定**: 「Apply」ボタンでVRChatに推奨されるLightmap設定を一括適用します。
- **メッシュ分析**: 「シーン内の高ポリゴンメッシュを検索」を押すと、容量を食っている重いモデルを特定できます。

---

## 5. トラブルシューティング
### エラーが起きたら
- **ヘルプタブ**: 「エラーログファイルを開く」ボタンから、詳細なログを確認できます。
- **バックアップ**: 「実行時にバックアップを作成」がオンの場合、変更前のシーンが保存されています。

### よくある質問
- **Q: マテリアルが変わってしまった**
    - A: 非破壊モードの場合、`Assets/WorldOptimizer/Clones` フォルダに生成された最適化済みマテリアルが割り当てられています。元に戻すには、オブジェクトのInspectorから元のマテリアルを割り当て直すか、Ctrl+ZでUndoしてください。
- **Q: 「Missing Script Removal」だけ実行したい**
    - A: 基本設定タブの「Missing Scriptの削除」の右にある「実行」ボタンを押してください。

---

*このドキュメントは生成AIによって作成されました。*
